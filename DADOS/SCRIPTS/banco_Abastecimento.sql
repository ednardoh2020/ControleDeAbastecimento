/******************************************************************************/
/***          Generated by IBExpert 2012.02.21 03/06/2018 12:34:29           ***/
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES NONE;

SET CLIENTLIB 'C:\Fortes\Prova_Tecnica\Controle de Abastecimentos\Dll\fbclient.dll';

CREATE DATABASE 'C:\Fortes\Prova_Tecnica\Controle de Abastecimentos\DADOS\Controle de Abastecimentos.fdb'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 16384
DEFAULT CHARACTER SET NONE COLLATION NONE;



/******************************************************************************/
/***                               Generators                               ***/
/******************************************************************************/

CREATE GENERATOR GEN_CODBOMBA;
SET GENERATOR GEN_CODBOMBA TO 5;

CREATE GENERATOR GEN_CODCAIXA;
SET GENERATOR GEN_CODCAIXA TO 3;

CREATE GENERATOR GEN_CODFPGTO;
SET GENERATOR GEN_CODFPGTO TO 9;

CREATE GENERATOR GEN_CODMOVIMENTOVENDA;
SET GENERATOR GEN_CODMOVIMENTOVENDA TO 10;

CREATE GENERATOR GEN_CODOPERADOR;
SET GENERATOR GEN_CODOPERADOR TO 4;

CREATE GENERATOR GEN_CODPRODUTO;
SET GENERATOR GEN_CODPRODUTO TO 10;

CREATE GENERATOR GEN_CODTANQUE;
SET GENERATOR GEN_CODTANQUE TO 3;



/******************************************************************************/
/***                                 Tables                                 ***/
/******************************************************************************/



CREATE TABLE TB_BOMBA (
    CD_BOMBA   VARCHAR(10) NOT NULL,
    DS_BOMBA   VARCHAR(60),
    CD_TANQUE  VARCHAR(10)
);

CREATE TABLE TB_CAIXA (
    CD_CAIXA  VARCHAR(10) NOT NULL,
    DS_CAIXA  VARCHAR(60)
);

CREATE TABLE TB_EMPRESA (
    CNPJ           VARCHAR(30) NOT NULL,
    RAZAO_SOCIAL   VARCHAR(100),
    NOME_FANTASIA  VARCHAR(60),
    ENDERECO       VARCHAR(100),
    CEP            VARCHAR(10),
    TELEFONE       VARCHAR(30),
    IE             VARCHAR(20),
    LOGOMARCA      BLOB SUB_TYPE 0 SEGMENT SIZE 80
);

CREATE TABLE TB_FPGTO (
    CD_FPGTO  VARCHAR(10) NOT NULL,
    DS_FPGTO  VARCHAR(60)
);

CREATE TABLE TB_MOVIMENTACAO_VENDAS (
    CD_MOVVENDAS   VARCHAR(10) NOT NULL,
    CD_PRODUTO     VARCHAR(13) NOT NULL,
    DT_MOVVENDAS   DATE,
    CD_TANQUE      VARCHAR(10),
    CD_BOMBA       VARCHAR(10),
    CD_OPERADOR    VARCHAR(10),
    CD_CAIXA       VARCHAR(10),
    CD_FPGTO       VARCHAR(10),
    DS_HISTORICO   VARCHAR(100),
    VALOR_VENDA    NUMERIC(15,2),
    DESCONTO       NUMERIC(15,2),
    TROCO          NUMERIC(15,2),
    QTD_PROD       NUMERIC(15,4),
    PRC_PROD       NUMERIC(15,4),
    VALOR_IMPOSTO  NUMERIC(15,4)
);

CREATE TABLE TB_OPERADOR (
    CD_OPERADOR  VARCHAR(10) NOT NULL,
    DS_OPERADOR  VARCHAR(60),
    COMISSAO     NUMERIC(15,2)
);

CREATE TABLE TB_PARAMETRO (
    CNPJ_EMPR     VARCHAR(30),
    CD_OPERADOR   VARCHAR(10),
    CD_CAIXA      VARCHAR(10),
    DT_ABERTURA   DATE,
    SLD_INICIAL   NUMERIC(15,2),
    IMPOSTO_PADR  NUMERIC(6,2),
    CD_FPGTO      VARCHAR(10),
    DESC_PADRAO   NUMERIC(15,2)
);

CREATE TABLE TB_PRODUTOS (
    CD_PRODUTO           VARCHAR(13) NOT NULL,
    DS_PRODUTO           VARCHAR(100),
    DS_REDUZIDO_PRODUTO  VARCHAR(30),
    UNIDADE_MEDIDA       VARCHAR(10),
    QTD_ESTOQUE          NUMERIC(15,4),
    PRC_PRODUTO          NUMERIC(15,4)
);

CREATE TABLE TB_TANQUE (
    CD_TANQUE       VARCHAR(10) NOT NULL,
    TP_COMBUSTIVEL  VARCHAR(60),
    TOTAL_LITROS    NUMERIC(15,4)
);



/******************************************************************************/
/***                              Primary Keys                              ***/
/******************************************************************************/

ALTER TABLE TB_BOMBA ADD CONSTRAINT PK_TB_BOMBA PRIMARY KEY (CD_BOMBA);
ALTER TABLE TB_CAIXA ADD CONSTRAINT PK_TB_CAIXA PRIMARY KEY (CD_CAIXA);
ALTER TABLE TB_FPGTO ADD CONSTRAINT PK_TB_FPGTO PRIMARY KEY (CD_FPGTO);
ALTER TABLE TB_MOVIMENTACAO_VENDAS ADD CONSTRAINT PK_TB_MOVIMENTACAO_VENDAS PRIMARY KEY (CD_MOVVENDAS, CD_PRODUTO);
ALTER TABLE TB_OPERADOR ADD CONSTRAINT PK_TB_OPERADOR PRIMARY KEY (CD_OPERADOR);
ALTER TABLE TB_PRODUTOS ADD CONSTRAINT PK_TB_PRODUTOS PRIMARY KEY (CD_PRODUTO);
ALTER TABLE TB_TANQUE ADD CONSTRAINT PK_TB_TANQUE PRIMARY KEY (CD_TANQUE);


/******************************************************************************/
/***                              Foreign Keys                              ***/
/******************************************************************************/

ALTER TABLE TB_BOMBA ADD CONSTRAINT FK_TB_BOMBA_1 FOREIGN KEY (CD_TANQUE) REFERENCES TB_TANQUE (CD_TANQUE);
ALTER TABLE TB_MOVIMENTACAO_VENDAS ADD CONSTRAINT FK_TB_MOVIMENTACAO_VENDAS_1 FOREIGN KEY (CD_TANQUE) REFERENCES TB_TANQUE (CD_TANQUE);
ALTER TABLE TB_MOVIMENTACAO_VENDAS ADD CONSTRAINT FK_TB_MOVIMENTACAO_VENDAS_2 FOREIGN KEY (CD_BOMBA) REFERENCES TB_BOMBA (CD_BOMBA);
ALTER TABLE TB_MOVIMENTACAO_VENDAS ADD CONSTRAINT FK_TB_MOVIMENTACAO_VENDAS_3 FOREIGN KEY (CD_PRODUTO) REFERENCES TB_PRODUTOS (CD_PRODUTO);
